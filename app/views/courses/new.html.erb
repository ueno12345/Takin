<% if flash[:color] == "red" %>
  <div class="red-text"><%= flash[:notice] %></div>
<% elsif flash[:color] == "green" %>
  <div class="green-text"><%= flash[:notice] %></div>
<% else %>
  <div><%= flash[:notice] %></div>
<% end %>

<h1>新規科目マスタデータ追加</h1>

<div>
  <%= link_to "科目一覧に戻る", courses_path %>
</div>

<%= select_tag :registration_type, options_for_select(["科目一括登録", "科目個別登録"]), id: "registration_type_select" %>
<div id="import_form" style="display: block;">
  <%= form_tag import_courses_path, multipart: true do %>
    <%= file_field_tag :file, accept: ".csv" %>
    <%= submit_tag "登録" %>
  <% end %>
</div>

<div id="individual_registration_form" style="display: none;">
  <%= render "form", course: @course %>
</div>

<script>
  document.addEventListener("turbo:load", function(){
    const registrationTypeSelect = document.getElementById("registration_type_select");
    const importForm = document.getElementById("import_form");
    const individualRegistrationForm = document.getElementById("individual_registration_form");

    registrationTypeSelect.addEventListener("change", function(){
      if (registrationTypeSelect.value === "科目一括登録"){
        importForm.style.display = "block";
        individualRegistrationForm.style.display = "none";
      }else if(registrationTypeSelect.value === "科目個別登録"){
        importForm.style.display = "none";
        individualRegistrationForm.style.display = "block";
      }
    });
  });
</script>

<form class="row g-3">
  <%= search_form_for @q, html: {class:"row g-3"} do |f| %>
    <div class="col-md-4">
      <%= f.label :year_eq, "対象年度" %>
      <%= f.select :year_eq, @select_years, {prompt:"対象年度を選択"} %>
    </div>
    <div class="col-md-4">
      <%= f.label :term_i_cont, "学期" %>
      <%= f.search_field :term_i_cont, placeholder: "条件を入力してください" %>
    </div>
    <div class="col-md-4">
      <%= f.label :number_i_cont, "科目番号" %>
      <%= f.search_field :number_i_cont, placeholder: "条件を入力してください" %>
    </div>
    <div class="col-md-4">
      <%= f.label :name_i_cont, "授業科目名" %>
      <%= f.search_field :name_i_cont, placeholder: "条件を入力してください" %>
    </div>
    <div class="col-md-4">
      <%= f.label :instructor_i_cont, "担当教員" %>
      <%= f.search_field :instructor_i_cont, placeholder: "条件を入力してください" %>
    </div>
    <div class="col-md-4">
      <%= f.label :description_i_cont, "備考" %>
      <%= f.search_field :description_i_cont, placeholder: "条件を入力してください" %>
    </div>
    <div class="col-12">
      <%= f.submit "検索", class: "btn btn-primary" %>
    </div>
  <% end %>
</form>

<br>
<table class="table table-bordered">
  <thead class="table-primary">
    <tr>
    <th>対象年度</th>
    <th>学期</th>
    <th>講義番号</th>
    <th>講義科目名</th>
    <th>担当教員</th>
    <th>TA可能割当総時間(分)</th>
    </tr>
  </thead>
  <tbody>
    <div id="courses">
      <% @courses.each do |course| %>
        <tr>
          <td><%= course.year %></td>
          <td><%= course.term %></td>
          <td><%= course.number %></td>
          <td><%= course.name %></td>
          <td><%= course.instructor %></td>
          <td><%= course.time_budget %></td>
        </tr>
      <% end %>
    </div>
  </tbody>
</table>