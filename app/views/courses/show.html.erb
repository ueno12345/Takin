<%# TA時間割当(閲覧)画面 %>
<% if flash[:color] == "red" %>
  <div class="red-text"><%= flash[:notice] %></div>
<% elsif flash[:color] == "green" %>
  <div class="green-text"><%= flash[:notice] %></div>
<% else %>
  <div><%= flash[:notice] %></div>
<% end %>

<h1>TA時間割当(閲覧)</h1>

<%= link_to "TA時間割当編集へ", course_assignments_path(@course) %>

<%= link_to "科目一覧画面へ", courses_path %>


<div>
  <span>
    <%= @course.name %>
  </span>
  担当教員: <%= @course.instructor %>
  対象年度: <%= @course.year %>
  開講学期: <%= @course.term %>
  割当可能総時間: <%= @course.time_budget %>
</div>

<form class="row g-3">
  <%= search_form_for @q, html: {class:"row g-3"} do |f| %>
    <div class="col-md-4">
      <%= f.label :teaching_assistant_name_i_cont, "TA名" %>
      <%= f.search_field :teaching_assistant_name_i_cont, placeholder: "条件を入力してください" %>
    </div>
    <div class="col-12">
      <%= f.submit "検索", class: "btn btn-primary" %>
    </div>
  <% end %>
</form>

<table class="table table-bordered">
    <tr>
      <th>開始時刻</th>
      <th>終了時刻</th>
      <th>合計勤務時間(分)</th>
      <th>TA名</th>
      <th>操作</th>
    </tr>
    <div id="assignments">
      <% @assignments.each do |assignment| %>
        <% if assignment.teaching_assistant.id == 1 %>
          <% next %>
        <% else %>
          <% assignment.work_hours.each do|work_hour| %>
            <tr>
              <td><%= work_hour.dtstart %></td>
              <td><%= work_hour.dtend %></td>
              <td><%= work_hour.actual_working_minutes %></td>
              <td><%= assignment.teaching_assistant.name %></td>
              <td>
                <%= link_to "帳票出力", index_output_excel_path(@teaching_assistant = assignment.teaching_assistant), target: :_blank, rel: "noopener noreferrer"  ,class: 'btn btn-info' %>
              </td>
            </tr>
          <% end %>
        <% end %>
      <% end %>
    </div>
</table>