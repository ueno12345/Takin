<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

<%# Top画面を表示 %>
<div class="row">
  <div class="col-lg-1 col-md-0"></div>
  <div class="col-lg-10 col-md-12">
    <div class="row">
      <div class="col-lg-10 col-md-12">
        <h1>HOME</h1>
      </div>
      <div class="col-lg-10 col-md-12 m-3">
        おかえりなさい． 「<%= session[:user_name] %>」さん．
      </div>
    </div>
  </div>
  <div class="col-lg-1 col-md-0"></div>
</div>

<%# マニュアル表示部 %>
<div class="row">
  <div class="col-lg-1 col-md-0"></div>
  <div class="col-lg-10 col-md-12">
    <h4 class="mt-5">利用マニュアル</h4>
    <%# 利用者と管理者共通マニュアル %>
    <div class="card my-3">
      <%# カードヘッダー %>
      <div class="card-header">
        <h4>利用者と管理者共通マニュアル</h4>
      </div>
      <%# カードボディ %>
      <div class="card-body">
        <%# マニュアル %>
        <details class="accordion manual-details" id="accordionExample">
          <summary class="card manual-summary">
              <h5 class="mb-0">
                <div class="btn btn-link">
                  グローバルナビゲーション
                </div>
              </h5>
          </summary>
          <div id="collapseOne" class="card-body">
            本システムはグローバルナビゲーションを搭載しており，どこからでも任意のページに遷移することが可能となっています．「HOME」，「TA一覧」，「科目一覧」，「ユーザ一覧※1」，「ログアウト※2」，それぞれのボタンに関して，以降で詳細を記載します．<br><br>
            ※1...管理者でログインした場合のみ表示．<br>
            ※2...ログアウトボタンは，グローバルナビゲーション右端にあるユーザのマークをクリックすることで下に表示されるようになります．
          </div>
        </details>

        <details class="accordion manual-details" id="accordionExample">
          <summary class="card manual-summary">
              <h5 class="mb-0">
                <div class="btn btn-link">
                  ログイン・ログアウト
                </div>
              </h5>
          </summary>
          <div id="collapseOne" class="card-body">
            <strong>ログイン</strong><br>
            管理者・利用者いずれの場合でも対応するリンクからアクセスすると，ログイン画面が表示されます．適当なアカウント情報（ユーザ名とパスワード）を入力し，ログインボタンを押下します．入力されたアカウント情報がシステムに登録されている場合，ログインに成功し，HOME画面に推移します．また，そうでない場合は，ログインに失敗し，エラーメッセージが追加されたログイン画面が表示されます．<br><br>
            <strong>ログアウト</strong><br>
            グローバルナビゲーション右端にあるユーザのマークをクリックし，出てくるログアウトボタンを押下します．そうすると，管理者・利用者いずれの場合でも利用者のログイン画面が表示されます．
          </div>
        </details>

        <details class="accordion manual-details" id="accordionExample">
          <summary class="card manual-summary">
              <h5 class="mb-0">
                <div class="btn btn-link">
                  HOME
                </div>
              </h5>
          </summary>
          <div id="collapseOne" class="card-body">
            HOMEはログイン後に表示される画面であり，利用マニュアルを確認することができます．確認したい項目を選択することで，文章の「展開 / 折りたたみ」の操作を行うことができます．
          </div>
        </details>

        <details class="accordion manual-details" id="accordionExample">
          <summary class="card manual-summary">
              <h5 class="mb-0">
                <div class="btn btn-link">
                  TA一覧
                </div>
              </h5>
          </summary>
          <div id="collapseOne" class="card-body">
            TA一覧の利用用途を以下に示します．<br>
            ・TAの勤務割当の詳細確認<br>
            ・TAの帳票出力<br>
            また，検索欄において，TAの情報を入力することにより，任意のTAを見つけやすくしています．グローバルナビゲーション中の「TA一覧」を選択することで，TA一覧画面を表示することができます．
          </div>
        </details>

        <details class="accordion manual-details" id="accordionExample">
          <summary class="card manual-summary">
              <h5 class="mb-0">
                <div class="btn btn-link">
                  科目一覧
                </div>
              </h5>
          </summary>
          <div id="collapseOne" class="card-body">
            科目一覧の利用用途を以下に示します．<br>
            ・科目毎のTA勤務割当を追加・編集・削除<br>
            ・科目毎のTAの勤務割当状況の閲覧<br>
            ・科目を担当するTAの帳票出力<br>
            また，検索欄において，科目の情報を入力することにより，任意の科目を見つけやすくしています．グローバルナビゲーション中の「科目一覧」を選択することで，科目一覧画面を表示することができます．
          </div>
        </details>

        <details class="accordion manual-details" id="accordionExample">
          <summary class="card manual-summary">
              <h5 class="mb-0">
                <div class="btn btn-link">
                  TA個人画面
                </div>
              </h5>
          </summary>
          <div id="collapseOne" class="card-body">
            TA個人画面は，特定のTAの勤務割当を確認する，または，帳票を出力する際に利用します．TA一覧画面で示される「個人画面」を選択することで表示することができます．また，TA勤務割当（編集）画面において，科目ごとにすでに割り振られたTAがいた場合に，「個人画面」を選択することでも表示ができます．
          </div>
        </details>

        <details class="accordion manual-details" id="accordionExample">
          <summary class="card manual-summary">
              <h5 class="mb-0">
                <div class="btn btn-link">
                  TA勤務割当
                </div>
              </h5>
          </summary>
          <div id="collapseOne" class="card-body">
            TA勤務割当は特定のコースにおける勤務割当を行うものです．以下の手順で勤務割当から削除までを行うことができます．これらの操作は全て勤務割当編集画面において行います．<br>

            <strong>（1）TA候補追加<br>
            （2）TA勤務割当追加<br>
            （3）TA勤務割当編集<br>
            （4）TA勤務割当削除<br></strong>

            勤務割当編集画面へのアクセス方法として，まず，グローバルナビゲーション中の科目一覧を選択し，科目一覧を表示します．その後，編集したい科目の「編集」を選択することでTA勤務割当（編集）画面へと遷移します．<br><br>

            <strong>TA候補追加・削除</strong><br>
            （1）TA候補追加<br>
            TA時間割当（編集）画面の「TA候補追加」を選択します．その際，TA候補追加画面に遷移します．このページにおいて勤務割当を行うTAをチェックリストから選択し，「選択したTAをすべて候補者として追加」を選択します．ここで選択したTA候補者は編集画面におけるTA選択のドロップダウンにおいて表示されるようになります．選択した候補者は「TA候補として登録済み」と表記されます．<br>

            （2）TA候補削除<br>
            TA時間割当（編集）「候補削除」を選択し，TA候補削除画面に遷移します．このページにおいて候補者をチェックリストから選択し，「選択したTAをすべて候補から削除」を選択することで，対応する情報を削除します．この際，本当に削除するかどうかのポップアップが表示されます．削除する場合は，「OK」を選択し削除を完了します．<br>

            ＊注意<br>
            削除しようとするTA候補に勤務割当が既に存在する場合，その勤務割当も共に削除されます．<br><br>

            <strong>TA勤務割当追加</strong><br>
            TA時間割当（編集）画面の「勤務追加」を選択します．その際，同画面のTA勤務割当処理テーブル最上部に新たなレコードが追加されます．ここで追加されたレコードには，以下の項目と制約があります．以下にある制約条件を満たさない入力で登録しようとした場合，エラーとその内容が画面上に表示されます．<br>
            <strong>・項目</strong><br>
            （1）日付
            （2）開始時刻<br>
            （3）終了時刻<br>
            （4）実働時間(分)<br>
            （5）割当TA名<br>
            <strong>・制約</strong><br>
            （1）開始時刻，終了時刻，実働時間は空欄を許容しない<br>
            （2）開始時刻は終了時刻を越えない<br>
            （3）実働時間は負の数を取らない<br>
            割当TA名に関しては，TA候補追加で選択したTAがドロップダウンで表示されます．この項目は必須ではなく，TAを選択しない場合には未登録を選択します．勤務割当を保存するには，「操作」の「登録」を選択します．<br><br>

            <strong>TA勤務割当編集</strong><br>
            編集を行おうとするレコードの隣に表示されている「編集」を選択します．項目と制約は，「TA勤務割当追加」と同様です．編集を保存するには，「操作」の「登録」を選択してください．<br><br>

            <strong>TA勤務割当削除</strong><br>
            TA時間割当（編集）画面の「削除」を選択します．この際，本当に削除するかどうかのポップアップが表示されます．削除する場合は，「OK」を選択し削除を完了します．
          </div>
        </details>

        <details class="accordion manual-details" id="accordionExample">
          <summary class="card manual-summary">
              <h5 class="mb-0">
                <div class="btn btn-link">
                  帳票出力
                </div>
              </h5>
          </summary>
          <div id="collapseOne" class="card-body">
            帳票確認のページには以下の箇所で遷移が可能です．各ページへのアクセス方法はそれぞれ，「TA個人画面」，「TA勤務割当」を参照してください．<br>
            （1）TA一覧画面<br>
            （2）TA個人画面<br>
            （3）勤務割当（編集）画面<br>
            出力フォーマットには，様式1と様式2が存在し，出力したい様式のボタンを選択することでダウンロードすることが可能です．なお，様式1は非常勤職員採用予定者調書学生用で，様式2は勤務予定表です．帳票確認ページではトグル形式で出力内容を確認することができます．また，様式1のダウンロードリンクに「1つ目」とありますが，これはTAが10以上の科目においてTA勤務を割り当てられていた場合，ファイルは分割されて様式1「1つ目」と様式1「2つ目」といった形で出力することを考慮したものとなっているためです．
          </div>
        </details>
      </div>
    </div>

    <% if session[:admin_flag] == true %>
    <%# 管理者マニュアル %>
    <div class="card my-3">
      <%# カードヘッダー %>
      <div class="card-header">
        <h4>管理者マニュアル</h4>
      </div>
      <%# カードボディ %>
      <div class="card-body">
        <%# マニュアル %>
        <details class="accordion manual-details" id="accordionExample">
          <summary class="card manual-summary">
              <h5 class="mb-0">
                <div class="btn btn-link">
                  ユーザ一覧
                </div>
              </h5>
          </summary>
          <div id="collapseOne" class="card-body">
            ユーザ一覧画面は，新しく利用者や管理者を追加する際に利用します．<br><br>

            <strong>ユーザ一覧へのアクセス方法</strong><br>
            グローバルナビゲーション中の「ユーザ一覧」を選択することで，ユーザ一覧画面を表示することができます．<br><br>

            <strong>新規ユーザ作成</strong><br>
            ユーザ一覧画面上部にある「新規作成」を選択することで，新規ユーザ作成画面を表示することができます．新規ユーザ作成画面において，アカウント名，パスワード，ユーザタイプ（管理者 or 利用者）を入力し，「登録」を選択することで，ユーザの登録ができます．<br><br>

            <strong>ユーザ編集</strong><br>
            ユーザ一覧画面で，「操作」の「編集」を選択することで，ユーザ編集画面を表示することができます．アカウント名とパスワードを入力し，「更新」を選択することで，ユーザ情報の編集ができます．
          </div>
        </details>

        <details class="accordion manual-details" id="accordionExample">
          <summary class="card manual-summary">
              <h5 class="mb-0">
                <div class="btn btn-link">
                  マスタデータ追加・削除
                </div>
              </h5>
          </summary>
          <div id="collapseOne" class="card-body">
            マスタデータの追加・削除には，TAと科目の二つが用意されています．それぞれ，CSVファイルによる一括登録と直で入力する個別登録が存在し，「TA一覧画面」，「科目一覧画面」において操作を行うことができます．ページへのアクセス方法はそれぞれ，「TA一覧画面」，「科目一覧画面」を参照してください．<br><br>

            <strong>TAマスタデータ追加・削除</strong><br>
            管理者でログインを行っている場合，TA一覧画面は「TAマスタデータを追加」と「TAマスタデータ削除」の項目が追加表示されます．「TAマスタデータ追加」を選択すると，TAマスタデータ追加画面に遷移します．ドロップダウンリストから，CSVファイルによる一括登録か直で入力する個別登録かを選択します．個別登録の場合，画面中央部にある入力フォームにそれぞれの情報を入力した後，「登録」を選択してください．一括登録の場合は，画面上部にある「ファイルを選択」で，CSVファイルを選択後「登録」を選択してください．<br>
            削除の場合は，TA一覧画面の「TAマスタデータ削除」を選択し，削除したいTAのボックスにチェックをつけ，「選択したものをすべて削除」を選択し，削除をおこなってください．<br><br>

            <strong>科目マスタデータ追加・削除</strong><br>
            管理者でログインを行っている場合，科目一覧画面に「科目マスタデータ追加」と「科目マスタデータ削除」の項目が表示されます．「科目マスタデータ追加」を選択すると，科目マスタデータ追加画面に遷移します．ドロップダウンリストから，CSVファイルによる一括登録か直で入力する個別登録かを選択します．個別登録の場合，画面中央部にある入力フォームにそれぞれの情報を入力した後，「登録」を選択してください．一括登録の場合は，画面上部にある「ファイルを選択」で，CSVファイルを選択後「登録」を選択してください．<br>
            削除の場合は，科目一覧画面の「科目マスタデータ削除」を選択し，削除したい科目のボックスにチェックをつけ，「選択したものをすべて削除」を選択し，削除をおこなってください．
          </div>
        </details>
      </div>
    </div>
    <% end %>
  </div>
  <div class="col-lg-1 col-md-0"></div>
</div>

<style>
.manual-summary {
  position: relative;
  display: block; /* 矢印を消す */
  padding: 10px 10px 10px 30px; /* アイコンの余白を開ける */
  cursor: pointer; /* カーソルをポインターに */
  font-weight: bold;
  background-color: #e2f0f7;
  transition: 0.2s;
}
.manual-summary:hover {
  background-color: #ccebfb;
}
.manual-summary::-webkit-details-marker {
  display: none;　/* 矢印を消す */
}

/* 疑似要素でアイコンを表示 */
.manual-summary:before,
.manual-summary:after {
  content: "";
  margin: auto 0 auto 10px;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
}
.manual-summary:before {
  width: 16px;
  height: 16px;
  border-radius: 4px;
  background-color: #1da1ff;
}
.manual-summary:after {
  left: 6px;
  width: 5px;
  height: 5px;
  border: 4px solid transparent;
  border-left: 5px solid #fff;
  box-sizing: border-box;
  transition: .1s;
}

/* オープン時のスタイル */
.manual-details[open] .manual-summary {
  background-color: #ccebfb;
}
.manual-details[open] .manual-summary:after {
  transform: rotate(90deg); /* アイコンを回転 */
  left: 4px; /* 位置を調整 */
  top: 5px; /* 位置を調整 */
}

.card-body {
  margin: 30px;
}

/* アニメーション */
.manual-details[open] .details-content {
  animation: fadeIn 0.5s ease;
}
@keyframes fadeIn {
  0% {
    opacity: 0;
    transform: translateY(-10px);
  }
  100% {
    opacity: 1;
    transform: none;
  }
}
</style>
