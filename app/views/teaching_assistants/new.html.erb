<%# 新規TAマスタデータ追加画面を表示 %>
<% if flash[:color] == "red" %>
  <div class="red-text"><%= flash[:notice] %></div>
<% elsif flash[:color] == "green" %>
  <div class="green-text"><%= flash[:notice] %></div>
<% else %>
  <div><%= flash[:notice] %></div>
<% end %>

<h1>新規TAマスタデータ追加</h1>

<div>
  <%= link_to "TA一覧に戻る", teaching_assistants_path %>
</div>

<%# 追加方法を選択 %>
<%= select_tag :registration_type, options_for_select(["TA個別登録", "TA一括登録"]), id: "registration_type_select" %>
<%# 個別登録を表示 %>
<div id="individual_registration_form" style="display: block;">
  <%= render "form", teaching_assistant: @teaching_assistant %>
</div>

<%# 一括登録フォームを表示 %>
<div id="import_form" style="display: none;">
  <%= form_tag import_teaching_assistants_path, multipart: true do %>
    <%= file_field_tag :file, accept: ".csv" %>
    <%= submit_tag "登録" %>
  <% end %>
</div>

<script>
  document.addEventListener("turbo:render", function(){
    const registrationTypeSelect = document.getElementById("registration_type_select");
    const importForm = document.getElementById("import_form");
    const individualRegistrationForm = document.getElementById("individual_registration_form");

    registrationTypeSelect.addEventListener("change", function(){
      if(registrationTypeSelect.value === "TA一括登録"){
        importForm.style.display = "block";
        individualRegistrationForm.style.display = "none";
      }else if(registrationTypeSelect.value === "TA個別登録"){
        importForm.style.display = "none";
        individualRegistrationForm.style.display = "block";
      }
    });
  });
</script>

<form class="row g-3">
  <%= search_form_for @q, html: {class:"row g-3"} do |f| %>
    <div class="col-md-4">
      <%= f.label :year_eq, "対象年度" %>
      <%= f.select :year_eq, @select_years, {prompt:"対象年度を選択"} %>
    </div>
    <div class="col-md-4">
      <%= f.label :name_i_cont, "TA名" %>
      <%= f.search_field :name_i_cont, placeholder: "条件を入力してください" %>
    </div>
    <div class="col-md-4">
      <%= f.label :number_i_cont, "学生番号" %>
      <%= f.search_field :number_i_cont, placeholder: "条件を入力してください" %>
    </div>
    <div class="col-md-4">
      <%= f.label :grade_i_cont, "学年" %>
      <%= f.search_field :grade_i_cont, placeholder: "条件を入力してください" %>
    </div>
    <div class="col-md-4">
      <%= f.label :labo_i_cont, "研究室" %>
      <%= f.search_field :labo_i_cont, placeholder: "条件を入力してください" %>
    </div>
    <div class="col-md-4">
      <%= f.label :description_i_cont, "備考" %>
      <%= f.search_field :description_i_cont, placeholder: "条件を入力してください" %>
    </div>
    <div class="col-12">
      <%= f.submit "検索", class: "btn btn-primary" %>
      <%= link_to "クリア", new_teaching_assistant_path, class: "btn btn-danger" %>
    </div>
  <% end %>
</form>

<br>

<table class="table table-bordered">
  <thead class="table-primary">
    <tr>
    <th>対象年度</th>
    <th>TA名</th>
    <th>学生番号</th>
    <th>学年</th>
    <th>研究室</th>
    <th>備考</th>
    </tr>
  </thead>
  <tbody>
    <div id="courses">
      <% @teaching_assistants.each do |teaching_assistant| %>
        <tr>
          <% if teaching_assistant.id == 1 %>
            <% next %>
          <% else %>
            <td><%= teaching_assistant.year %></td>
            <td><%= teaching_assistant.name %></td>
            <td><%= teaching_assistant.number %></td>
            <td><%= teaching_assistant.grade %></td>
            <td><%= teaching_assistant.labo %></td>
            <td><%= teaching_assistant.description %></td>
          <% end %>
        </tr>
      <% end %>
    </div>
  </tbody>
</table>
